---
title: Transformer Component
description: Learn about the Transformer component that handles code transformations, plugin system, and custom transformation capabilities
---

# Transformer

The Transformer is a powerful component of the Solo Build system that modifies your code's Abstract Syntax Tree (AST) to implement optimizations, transformations, and code modifications.

## Overview

The Transformer takes the AST generated by the Parser and applies a series of transformations to it. These transformations can range from simple syntax conversions to complex code optimizations. The modified AST is then passed to the Generator to produce the final output files.

## Features

### Code Transformations

The Transformer supports various code transformations:

- **Syntax Transformations**: Convert modern JavaScript/TypeScript to older versions for compatibility
- **TypeScript Compilation**: Remove type annotations and convert TypeScript-specific syntax
- **JSX/TSX Transformation**: Convert JSX/TSX to regular JavaScript function calls
- **Minification**: Reduce code size by removing unnecessary characters and simplifying expressions
- **Dead Code Elimination**: Remove code that is never executed
- **Tree Shaking**: Eliminate unused exports to reduce bundle size

### Plugin System

The Transformer includes a flexible plugin system:

- **Built-in Plugins**: Common transformations like TypeScript compilation and JSX conversion
- **Custom Plugins**: Create your own transformers for project-specific needs
- **Plugin Ordering**: Control the order in which transformations are applied
- **Conditional Transformations**: Apply transformations based on file patterns or other conditions

### Source Maps

The Transformer maintains source map information:

- **Source Map Generation**: Create source maps to map transformed code back to original source
- **Source Map Chaining**: Properly chain source maps through multiple transformation steps
- **Inline Source Maps**: Option to include source maps directly in the output files

## Usage

### Basic Usage

The Transformer is automatically used when you run the build command:

```bash
npx solo-build run
```

### Configuration

You can configure the Transformer in your `solo-build.config.js` file:

```javascript
module.exports = {
  // ... other configuration options
  transformer: {
    target: 'es2018',
    module: 'commonjs', // or 'esm'
    jsx: 'react', // or 'preact', 'vue', etc.
    minify: true,
    plugins: [
      // Built-in plugins
      '@solo-build/plugin-typescript',
      '@solo-build/plugin-jsx',
      
      // Custom plugins
      './transformers/custom-plugin.js',
      
      // Plugin with options
      ['@solo-build/plugin-minify', {
        removeConsole: true,
        mangle: true
      }]
    ]
  }
};
```

### Programmatic Usage

You can also use the Transformer programmatically in your own code:

```typescript
import { Transformer } from '@solo-build/transformer';
import { Parser } from '@solo-build/parser';

// Create a transformer instance
const transformer = new Transformer({
  target: 'es2018',
  plugins: ['@solo-build/plugin-typescript']
});

// Parse a file
const parser = new Parser();
const parseResult = await parser.parseFile('src/index.ts');

// Transform the AST
const transformResult = transformer.transform(parseResult.ast, {
  filePath: 'src/index.ts',
  sourceMap: parseResult.sourceMap
});

console.log(transformResult.ast);
```

## Creating Custom Transformers

You can create custom transformers to implement project-specific transformations:

```javascript
// custom-transformer.js
module.exports = {
  name: 'custom-transformer',
  transform: (ast, context) => {
    return {
      visitor: {
        // Transform function calls
        CallExpression(path) {
          if (path.node.callee.name === 'console' && 
              path.node.callee.property.name === 'log') {
            // Replace console.log with custom logger
            path.node.callee.object.name = 'logger';
          }
        },
        
        // Transform string literals
        StringLiteral(path) {
          // Add a prefix to all string literals
          path.node.value = `PREFIX_${path.node.value}`;
        }
      }
    };
  }
};
```

## API Reference

### TransformResult Interface

The Transformer returns a `TransformResult` object with the following structure:

```typescript
interface TransformResult {
  ast: AST;
  code?: string;
  map?: SourceMap;
  dependencies: string[];
  errors: TransformError[];
  warnings: TransformWarning[];
}

interface TransformError {
  message: string;
  line: number;
  column: number;
  plugin: string;
}

interface TransformWarning {
  message: string;
  line: number;
  column: number;
  plugin: string;
}
```

### Transformer Plugin Interface

Custom transformer plugins should implement the following interface:

```typescript
interface TransformerPlugin {
  name: string;
  transform: (ast: AST, context: TransformContext) => PluginResult;
}

interface TransformContext {
  filePath: string;
  sourceCode: string;
  options: Record<string, any>;
  addDependency: (dependency: string) => void;
  warn: (message: string, location?: Location) => void;
  error: (message: string, location?: Location) => void;
}

interface PluginResult {
  visitor: Visitor;
  preTransform?: (ast: AST) => AST;
  postTransform?: (ast: AST) => AST;
}
```

## Integration with Other Components

The Transformer works closely with other Solo Build components:

- **Parser**: Receives ASTs from the Parser to transform
- **Analyzer**: Uses analysis results to guide transformations
- **Generator**: Passes transformed ASTs to the Generator for output file creation

## Examples

### TypeScript to JavaScript Transformation

```javascript
// solo-build.config.js
module.exports = {
  transformer: {
    target: 'es2018',
    plugins: ['@solo-build/plugin-typescript']
  }
};
```

### React JSX Transformation

```javascript
// solo-build.config.js
module.exports = {
  transformer: {
    jsx: 'react',
    jsxImportSource: 'react',
    jsxFactory: 'createElement',
    jsxFragment: 'Fragment',
    plugins: ['@solo-build/plugin-jsx']
  }
};
```

### Custom Code Modification

```javascript
// remove-console-logs.js
module.exports = {
  name: 'remove-console-logs',
  transform: (ast, context) => {
    return {
      visitor: {
        CallExpression(path) {
          if (
            path.node.callee.type === 'MemberExpression' &&
            path.node.callee.object.name === 'console' &&
            path.node.callee.property.name === 'log'
          ) {
            path.remove();
          }
        }
      }
    };
  }
};

// solo-build.config.js
module.exports = {
  transformer: {
    plugins: ['./remove-console-logs.js']
  }
};
```

## Best Practices

1. **Order Plugins Correctly**: Place plugins in the correct order, as each transformation builds on the previous one
2. **Use Source Maps**: Always enable source maps for better debugging
3. **Test Transformations**: Thoroughly test custom transformations on a variety of code patterns
4. **Optimize for Performance**: Keep transformations as simple and efficient as possible
5. **Handle Errors Gracefully**: Implement proper error handling in custom transformers
